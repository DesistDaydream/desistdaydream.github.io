<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>断念梦 – XML 文件详解</title><link>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/</link><description>Recent content in XML 文件详解 on 断念梦</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><atom:link href="https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: XML 文件详解</title><link>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/</guid><description>
&lt;h1 id="概述">概述&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://libvirt.org/format.html">官方文档，XML 格式&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>Libvirt API 中的&lt;strong>对象&lt;/strong>使用 &lt;a href="https://desistdaydream.github.io/docs/2.%E7%BC%96%E7%A8%8B/%E6%97%A0%E6%B3%95%E5%88%86%E7%B1%BB%E7%9A%84%E8%AF%AD%E8%A8%80/XML.md">&lt;strong>XML 格式&lt;/strong>&lt;/a> 的文档进行配置，以便在未来的版本中轻松扩展。每个 XML 文档都有一个关联的 Relax-NG 模式，可用于在使用前验证文档。&lt;/p>
&lt;p>这里面的 Libvirt API 对象指的就是 Domain(虚拟机)、存储、快照、网络 等等。对于 Libvirt，所有 VM 相关的资源都会抽象为对象，这样也利于代码编写。&lt;/p>
&lt;blockquote>
&lt;p>Kubernetes 的 API 对象跟这个有点像，只不过 Kubernetes 中，使用 YAML 格式而不是 XML 格式来声明对象而不是配置对象。&lt;/p>
&lt;/blockquote>
&lt;p>下面是&lt;strong>根元素&lt;/strong>的名称，每个根元素都对应一个 &lt;strong>Libvirt 对象&lt;/strong>。&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML%20%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Domain.md">Domain&lt;/a> # 虚拟机相关的 XML 配置，可以直接使用 Domains XML 创建、启动、管理虚拟机。&lt;/li>
&lt;li>&lt;a href="docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML%20%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Network.md">Network&lt;/a> # 虚拟网络相关的 XML 配置。&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatnwfilter.html">Network filtering&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatnetworkport.html">Network ports&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatstorage.html">Storage&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatstorageencryption.html">Storage encryption&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatcaps.html">Capabilities&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatdomaincaps.html">Domain capabilities&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatstoragecaps.html">Storage Pool capabilities&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatnode.html">Node devices&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatsecret.html">Secrets&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatsnapshot.html">Snapshots&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatcheckpoint.html">Checkpoints&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://libvirt.org/formatbackup.html">Backup jobs&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="virt-xml-validate">virt-xml-validate&lt;/h1>
&lt;p>virt-xml-validate 工具是一个简单的检验 XML 文档的工具，直接在命令后面加上 XML 文档的 /PATH/FILE 即可对该文件进行检验，确保其在传递给 libvirt 时是正确的。&lt;/p></description></item><item><title>Docs: Domain</title><link>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Domain/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Domain/</guid><description>
&lt;h1 id="概述">概述&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://libvirt.org/formatdomain.html">官方文档，Domain XML 格式&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>Domain 元素中有如下属性：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>type&lt;/strong> # 指定用于运行域的管理程序。允许的值是特定于驱动程序的，但包括“xen”、“kvm”、“hvf”（自 8.1.0 和 QEMU 2.12 起）、“qemu”和“lxc”。&lt;/li>
&lt;li>&lt;strong>id&lt;/strong> # 它是正在运行的客户机的唯一整数标识符。非活动机器没有 id 值。&lt;/li>
&lt;/ul>
&lt;p>下列元素都属于 &lt;code>&amp;lt;domain&amp;gt;&lt;/code> 这个根元素的子元素&lt;/p>
&lt;ul>
&lt;li>TODO:&lt;/li>
&lt;li>&amp;hellip;&amp;hellip;&lt;/li>
&lt;li>&lt;a href="#devices">devices&lt;/a>&lt;/li>
&lt;li>&amp;hellip;&amp;hellip;&lt;/li>
&lt;/ul>
&lt;h1 id="devices">Devices&lt;/h1>
&lt;p>&lt;a href="https://libvirt.org/formatdomain.html#devices">https://libvirt.org/formatdomain.html#devices&lt;/a>&lt;/p>
&lt;h2 id="network-interfaces">Network interfaces&lt;/h2>
&lt;p>&lt;a href="https://libvirt.org/formatdomain.html#network-interfaces">https://libvirt.org/formatdomain.html#network-interfaces&lt;/a>&lt;/p>
&lt;h3 id="quality-of-serviceqos">Quality of service(QOS)&lt;/h3>
&lt;p>&lt;strong>bandwidth&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>bandwidth 元素可以为虚拟机中的每张网卡设置 QOS(服务质量)，可以为流量的出与入分别设置。QOS 下可用的元素详见 &lt;a href="https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML%20%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Network.md">Network XML&lt;/a> 的 &lt;a href="https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML%20%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Network.md#bandwidth">bandwidth 元素&lt;/a>。&lt;/li>
&lt;/ul>
&lt;h1 id="graphical-framebuffers">Graphical framebuffers&lt;/h1>
&lt;p>&lt;a href="https://libvirt.org/formatdomain.html#graphical-framebuffers">https://libvirt.org/formatdomain.html#graphical-framebuffers&lt;/a>&lt;/p></description></item><item><title>Docs: Network</title><link>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Network/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/10.%E4%BA%91%E5%8E%9F%E7%94%9F/1.2.%E5%AE%9E%E7%8E%B0%E8%99%9A%E6%8B%9F%E5%8C%96%E7%9A%84%E5%B7%A5%E5%85%B7/%E8%99%9A%E6%8B%9F%E5%8C%96%E7%AE%A1%E7%90%86/Libvirt/XML-%E6%96%87%E4%BB%B6%E8%AF%A6%E8%A7%A3/Network/</guid><description>
&lt;h1 id="概述">概述&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://libvirt.org/formatnetwork.html">官方文档，Network XML 格式&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>使用 &lt;code>virsh net-list&lt;/code> 命令列出所有网络&lt;/p>
&lt;h1 id="bandwidth">bandwidth&lt;/h1>
&lt;p>&lt;code>&amp;lt;bandwidth&amp;gt;&lt;/code>元素允许为特定网络设置服务质量（自0.9.4版起）。只支持为具有 &lt;code>&amp;lt;forward&amp;gt;&lt;/code> 模式为route、nat、bridge或没有模式的网络（即“隔离”网络）设置带宽。不支持为forward模式为passthrough、private或hostdev的网络设置带宽。尝试这样做将导致无法定义网络或创建临时网络。&lt;/p>
&lt;p>average&lt;/p>
&lt;p>peak&lt;/p>
&lt;p>burst&lt;/p>
&lt;h1 id="最佳实践">最佳实践&lt;/h1>
&lt;p>限制虚拟机网卡的网宿&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-xml" data-lang="xml">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;interface&lt;/span> &lt;span style="color:#a6e22e">type=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;bridge&amp;#39;&lt;/span>&lt;span style="color:#f92672">&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;source&lt;/span> &lt;span style="color:#a6e22e">bridge=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;br0&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;model&lt;/span> &lt;span style="color:#a6e22e">type=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;virtio&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;driver&lt;/span> &lt;span style="color:#a6e22e">name=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;vhost&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">queues=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;8&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;bandwidth&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;inbound&lt;/span> &lt;span style="color:#a6e22e">average=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;1000&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">peak=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;5000&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">burst=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;1024&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;outbound&lt;/span> &lt;span style="color:#a6e22e">average=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;128&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">peak=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;256&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">burst=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;256&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/bandwidth&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;address&lt;/span> &lt;span style="color:#a6e22e">type=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;pci&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">domain=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;0x0000&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">bus=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;0x01&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">slot=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;0x00&amp;#39;&lt;/span> &lt;span style="color:#a6e22e">function=&lt;/span>&lt;span style="color:#e6db74">&amp;#39;0x0&amp;#39;&lt;/span>&lt;span style="color:#f92672">/&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;lt;/interface&amp;gt;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>断念梦的站点 – ansible.builtin(内置模块)</title><link>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/</link><description>Recent content in ansible.builtin(内置模块) on 断念梦的站点</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><atom:link href="https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/index.xml" rel="self" type="application/rss+xml"/><item><title>Docs: System 模块</title><link>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/System-%E6%A8%A1%E5%9D%97/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/System-%E6%A8%A1%E5%9D%97/</guid><description>
&lt;h1 id="概述">概述&lt;a class="td-heading-self-link" href="#%e6%a6%82%e8%bf%b0" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/list_of_system_modules.html">2.9 官方文档，用户指南-使用模块-System 模块&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/aix_devices_module.html#aix-devices-module">aix_devices – Manages AIX devices&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/aix_filesystem_module.html#aix-filesystem-module">aix_filesystem – Configure LVM and NFS file systems for AIX&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/aix_inittab_module.html#aix-inittab-module">aix_inittab – Manages the inittab on AIX&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/aix_lvg_module.html#aix-lvg-module">aix_lvg – Manage LVM volume groups on AIX&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/aix_lvol_module.html#aix-lvol-module">aix_lvol – Configure AIX LVM logical volumes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/alternatives_module.html#alternatives-module">alternatives – Manages alternative programs for common commands&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/at_module.html#at-module">at – Schedule the execution of a command or script file via the at command&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/authorized_key_module.html#authorized-key-module">authorized_key – Adds or removes an SSH authorized key&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/awall_module.html#awall-module">awall – Manage awall policies&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/beadm_module.html#beadm-module">beadm – Manage ZFS boot environments on FreeBSD/Solaris/illumos systems&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/capabilities_module.html#capabilities-module">capabilities – Manage Linux capabilities&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/cron_module.html#cron-module">cron – Manage cron.d and crontab entries&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/cronvar_module.html#cronvar-module">cronvar – Manage variables in crontabs&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/crypttab_module.html#crypttab-module">crypttab – Encrypted Linux block devices&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/dconf_module.html#dconf-module">dconf – Modify and read dconf database&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/debconf_module.html#debconf-module">debconf – Configure a .deb package&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/facter_module.html#facter-module">facter – Runs the discovery program facter on the remote system&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/filesystem_module.html#filesystem-module">filesystem – Makes a filesystem&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/firewalld_module.html#firewalld-module">firewalld – Manage arbitrary ports/services with firewalld&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/gather_facts_module.html#gather-facts-module">gather_facts – Gathers facts about remote hosts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/gconftool2_module.html#gconftool2-module">gconftool2 – Edit GNOME Configurations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/getent_module.html#getent-module">getent – A wrapper to the unix getent utility&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/group_module.html#group-module">group – Add or remove groups&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/hostname_module.html#hostname-module">hostname – Manage hostname&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/interfaces_file_module.html#interfaces-file-module">interfaces_file – Tweak settings in /etc/network/interfaces files&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/iptables_module.html#iptables-module">iptables – Modify iptables rules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/java_cert_module.html#java-cert-module">java_cert – Uses keytool to import/remove key from java keystore (cacerts)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/java_keystore_module.html#java-keystore-module">java_keystore – Create or delete a Java keystore in JKS format&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/kernel_blacklist_module.html#kernel-blacklist-module">kernel_blacklist – Blacklist kernel modules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/known_hosts_module.html#known-hosts-module">known_hosts – Add or remove a host from the known_hosts file&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/listen_ports_facts_module.html#listen-ports-facts-module">listen_ports_facts – Gather facts on processes listening on TCP and UDP ports&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/locale_gen_module.html#locale-gen-module">locale_gen – Creates or removes locales&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/lvg_module.html#lvg-module">lvg – Configure LVM volume groups&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/lvol_module.html#lvol-module">lvol – Configure LVM logical volumes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/make_module.html#make-module">make – Run targets in a Makefile&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/mksysb_module.html#mksysb-module">mksysb – Generates AIX mksysb rootvg backups&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/modprobe_module.html#modprobe-module">modprobe – Load or unload kernel modules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/mount_module.html#mount-module">mount – Control active and configured mount points&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/nosh_module.html#nosh-module">nosh – Manage services with nosh&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/ohai_module.html#ohai-module">ohai – Returns inventory data from Ohai&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/open_iscsi_module.html#open-iscsi-module">open_iscsi – Manage iSCSI targets with Open-iSCSI&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/openwrt_init_module.html#openwrt-init-module">openwrt_init – Manage services on OpenWrt&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/osx_defaults_module.html#osx-defaults-module">osx_defaults – Manage macOS user defaults&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pam_limits_module.html#pam-limits-module">pam_limits – Modify Linux PAM limits&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pamd_module.html#pamd-module">pamd – Manage PAM Modules&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/parted_module.html#parted-module">parted – Configure block device partitions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pids_module.html#pids-module">pids – Retrieves process IDs list if the process is running otherwise return empty list&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/ping_module.html#ping-module">ping – Try to connect to host, verify a usable python and return pong on success&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/puppet_module.html#puppet-module">puppet – Runs puppet&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/python_requirements_info_module.html#python-requirements-info-module">python_requirements_info – Show python path and assert dependency versions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/reboot_module.html#reboot-module">reboot – Reboot a machine&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/runit_module.html#runit-module">runit – Manage runit services&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/seboolean_module.html#seboolean-module">seboolean – Toggles SELinux booleans&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/sefcontext_module.html#sefcontext-module">sefcontext – Manages SELinux file context mapping definitions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/selinux_module.html#selinux-module">selinux – Change policy and state of SELinux&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/selinux_permissive_module.html#selinux-permissive-module">selinux_permissive – Change permissive domain in SELinux policy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/selogin_module.html#selogin-module">selogin – Manages linux user to SELinux user mapping&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/seport_module.html#seport-module">seport – Manages SELinux network port type definitions&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/service_module.html#service-module">service – Manage services&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/service_facts_module.html#service-facts-module">service_facts – Return service state information as fact data&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/setup_module.html#setup-module">setup – Gathers facts about remote hosts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/solaris_zone_module.html#solaris-zone-module">solaris_zone – Manage Solaris zones&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/svc_module.html#svc-module">svc – Manage daemontools services&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/sysctl_module.html#sysctl-module">sysctl – Manage entries in sysctl.conf&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/syspatch_module.html#syspatch-module">syspatch – Manage OpenBSD system patches&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/systemd_module.html#systemd-module">systemd – Manage services&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/sysvinit_module.html#sysvinit-module">sysvinit – Manage SysV services&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/timezone_module.html#timezone-module">timezone – Configure timezone setting&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/ufw_module.html#ufw-module">ufw – Manage firewall with UFW&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/user_module.html#user-module">user – Manage user accounts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/vdo_module.html#vdo-module">vdo – Module to control VDO&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/xfconf_module.html#xfconf-module">xfconf – Edit XFCE4 Configurations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/xfs_quota_module.html#xfs-quota-module">xfs_quota – Manage quotas on XFS filesystems&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="setup---收集受管理节点的信息">setup - 收集受管理节点的信息&lt;a class="td-heading-self-link" href="#setup---%e6%94%b6%e9%9b%86%e5%8f%97%e7%ae%a1%e7%90%86%e8%8a%82%e7%82%b9%e7%9a%84%e4%bf%a1%e6%81%af" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>setup 模块在 Ansible 执行时自动运行，收集到的信息会以 &lt;a href="https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible%20Variables/Fact%20Variables.md">Fact 变量&lt;/a>的形式保存。&lt;/p>
&lt;h1 id="systemd---控制远程主机上以-systemd-运行的服务">systemd - 控制远程主机上以 systemd 运行的服务&lt;a class="td-heading-self-link" href="#systemd---%e6%8e%a7%e5%88%b6%e8%bf%9c%e7%a8%8b%e4%b8%bb%e6%9c%ba%e4%b8%8a%e4%bb%a5-systemd-%e8%bf%90%e8%a1%8c%e7%9a%84%e6%9c%8d%e5%8a%a1" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/systemd_module.html">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/systemd_module.html&lt;/a>&lt;/p>
&lt;h2 id="参数">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;strong>name(STRING)&lt;/strong> # Unit 的名称&lt;/li>
&lt;li>&lt;strong>state(STRING)&lt;/strong> # 设置 Unit 的状态。可用的值有
&lt;ul>
&lt;li>reloaded&lt;/li>
&lt;li>restarted&lt;/li>
&lt;li>started&lt;/li>
&lt;li>stopped&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>&lt;strong>enabled(BOOLEAN)&lt;/strong> # 设置 Unit 是否应该自启动&lt;/li>
&lt;/ul>
&lt;h3 id="使用示例">使用示例&lt;a class="td-heading-self-link" href="#%e4%bd%bf%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">启动并设置自启动kubelet与kube-proxy服务&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">systemd&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{item}}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">daemon_reload&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">started&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">enabled&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">with_items&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kubelet&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#ae81ff">kube-proxy&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="user---管理远程主机上的用户账户">user - 管理远程主机上的用户账户&lt;a class="td-heading-self-link" href="#user---%e7%ae%a1%e7%90%86%e8%bf%9c%e7%a8%8b%e4%b8%bb%e6%9c%ba%e4%b8%8a%e7%9a%84%e7%94%a8%e6%88%b7%e8%b4%a6%e6%88%b7" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html&lt;/p>
&lt;h2 id="参数-1">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0-1" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>user 模块使用示例：该示例同样适用于更改密码&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">创建k8s用户&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">developer&lt;/span> &lt;span style="color:#75715e"># 指定要创建的用户名&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">password&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;$6$mysecretsalt$QjSLl.VQoxPKJkBE9.oLX82C5P4tAMH8UfFRpkxgkqSg2GNob8Y39hj5/cl7o0gbpPXVBGaB9oLuCPfVhIhyA0&amp;#34;&lt;/span> &lt;span style="color:#75715e"># 使用下面Note中的命令来获取加密后的密码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">同时更改多个用户的密码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">user&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ item.name }}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">password&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;{{ item.chpass | password_hash(&amp;#39;sha512&amp;#39;) }}&amp;#34;&lt;/span> &lt;span style="color:#75715e"># 也可以直接使用明文作为密码&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">update_password&lt;/span>: &lt;span style="color:#ae81ff">always&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">with_items&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - { &lt;span style="color:#f92672">name: &amp;#39;root&amp;#39;, chpass&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;admin#123&amp;#39;&lt;/span> }
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - { &lt;span style="color:#f92672">name: &amp;#39;test&amp;#39;, chpass&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;yjun@123&amp;#39;&lt;/span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note：生成加密密码的方式&lt;/p>
&lt;ul>
&lt;li>ansible all -i localhost, -m debug -a &amp;ldquo;msg={{ &amp;lsquo;mypassword&amp;rsquo; | password_hash(&amp;lsquo;sha512&amp;rsquo;, &amp;lsquo;mysecretsalt&amp;rsquo;) }}&amp;rdquo;
&lt;ul>
&lt;li>命令中的 mypassword 就是想要使用的密码，mysecretsalt 则是密码学中加的盐，详见&lt;a href="https://zh.wikipedia.org/wiki/%E7%9B%90_(%E5%AF%86%E7%A0%81%E5%AD%A6)">https://zh.wikipedia.org/wiki/%E7%9B%90_(%E5%AF%86%E7%A0%81%E5%AD%A6)&lt;/a>&lt;/li>
&lt;li>将输出信息引号内的部分直接当做 password 的值即可&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Docs: ansible.builtin(内置模块)</title><link>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/</guid><description>
&lt;h1 id="概述">概述&lt;a class="td-heading-self-link" href="#%e6%a6%82%e8%bf%b0" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/index_module.html#ansible-builtin">官方文档,参考-所有模块和插件的索引-所有模块的索引-ansible.builtin&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/add_host_module.html#ansible-collections-ansible-builtin-add-host-module">ansible.builtin.add_host&lt;/a> – Add a host (and alternatively a group) to the ansible-playbook in-memory inventory&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_module.html#ansible-collections-ansible-builtin-apt-module">ansible.builtin.apt&lt;/a> – Manages apt-packages&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_key_module.html#ansible-collections-ansible-builtin-apt-key-module">ansible.builtin.apt_key&lt;/a> – Add or remove an apt key&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/apt_repository_module.html#ansible-collections-ansible-builtin-apt-repository-module">ansible.builtin.apt_repository&lt;/a> – Add and remove APT repositories&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/assemble_module.html#ansible-collections-ansible-builtin-assemble-module">ansible.builtin.assemble&lt;/a> – Assemble configuration files from fragments&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/assert_module.html#ansible-collections-ansible-builtin-assert-module">ansible.builtin.assert&lt;/a> – Asserts given expressions are true&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/async_status_module.html#ansible-collections-ansible-builtin-async-status-module">ansible.builtin.async_status&lt;/a> – Obtain status of asynchronous task&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/blockinfile_module.html#ansible-collections-ansible-builtin-blockinfile-module">ansible.builtin.blockinfile&lt;/a> – Insert/update/remove a text block surrounded by marker lines&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html#ansible-collections-ansible-builtin-command-module">ansible.builtin.command&lt;/a> – Execute commands on targets&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html#ansible-collections-ansible-builtin-copy-module">ansible.builtin.copy&lt;/a> – Copy files to remote locations&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/cron_module.html#ansible-collections-ansible-builtin-cron-module">ansible.builtin.cron&lt;/a> – Manage cron.d and crontab entries&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/debconf_module.html#ansible-collections-ansible-builtin-debconf-module">ansible.builtin.debconf&lt;/a> – Configure a .deb package&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/debug_module.html#ansible-collections-ansible-builtin-debug-module">ansible.builtin.debug&lt;/a> – Print statements during execution&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/dnf_module.html#ansible-collections-ansible-builtin-dnf-module">ansible.builtin.dnf&lt;/a> – Manages packages with the dnf package manager&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/dpkg_selections_module.html#ansible-collections-ansible-builtin-dpkg-selections-module">ansible.builtin.dpkg_selections&lt;/a> – Dpkg package selection selections&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/expect_module.html#ansible-collections-ansible-builtin-expect-module">ansible.builtin.expect&lt;/a> – Executes a command and responds to prompts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/fail_module.html#ansible-collections-ansible-builtin-fail-module">ansible.builtin.fail&lt;/a> – Fail with custom message&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/fetch_module.html#ansible-collections-ansible-builtin-fetch-module">ansible.builtin.fetch&lt;/a> – Fetch files from remote nodes&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html#ansible-collections-ansible-builtin-file-module">ansible.builtin.file&lt;/a> – Manage files and file properties&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/find_module.html#ansible-collections-ansible-builtin-find-module">ansible.builtin.find&lt;/a> – Return a list of files based on specific criteria&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/gather_facts_module.html#ansible-collections-ansible-builtin-gather-facts-module">ansible.builtin.gather_facts&lt;/a> – Gathers facts about remote hosts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/get_url_module.html#ansible-collections-ansible-builtin-get-url-module">ansible.builtin.get_url&lt;/a> – Downloads files from HTTP, HTTPS, or FTP to node&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/getent_module.html#ansible-collections-ansible-builtin-getent-module">ansible.builtin.getent&lt;/a> – A wrapper to the unix getent utility&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/git_module.html#ansible-collections-ansible-builtin-git-module">ansible.builtin.git&lt;/a> – Deploy software (or files) from git checkouts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/group_module.html#ansible-collections-ansible-builtin-group-module">ansible.builtin.group&lt;/a> – Add or remove groups&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/group_by_module.html#ansible-collections-ansible-builtin-group-by-module">ansible.builtin.group_by&lt;/a> – Create Ansible groups based on facts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/hostname_module.html#ansible-collections-ansible-builtin-hostname-module">ansible.builtin.hostname&lt;/a> – Manage hostname&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/import_playbook_module.html#ansible-collections-ansible-builtin-import-playbook-module">ansible.builtin.import_playbook&lt;/a> – Import a playbook&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/import_role_module.html#ansible-collections-ansible-builtin-import-role-module">ansible.builtin.import_role&lt;/a> – Import a role into a play&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/import_tasks_module.html#ansible-collections-ansible-builtin-import-tasks-module">ansible.builtin.import_tasks&lt;/a> – Import a task list&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_module.html#ansible-collections-ansible-builtin-include-module">ansible.builtin.include&lt;/a> – Include a play or task list&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_role_module.html#ansible-collections-ansible-builtin-include-role-module">ansible.builtin.include_role&lt;/a> – Load and execute a role&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_tasks_module.html#ansible-collections-ansible-builtin-include-tasks-module">ansible.builtin.include_tasks&lt;/a> – Dynamically include a task list&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/include_vars_module.html#ansible-collections-ansible-builtin-include-vars-module">ansible.builtin.include_vars&lt;/a> – Load variables from files, dynamically within a task&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/iptables_module.html#ansible-collections-ansible-builtin-iptables-module">ansible.builtin.iptables&lt;/a> – Modify iptables rules&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/known_hosts_module.html#ansible-collections-ansible-builtin-known-hosts-module">ansible.builtin.known_hosts&lt;/a> – Add or remove a host from the known_hosts file&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html#ansible-collections-ansible-builtin-lineinfile-module">ansible.builtin.lineinfile&lt;/a> – Manage lines in text files&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/meta_module.html#ansible-collections-ansible-builtin-meta-module">ansible.builtin.meta&lt;/a> – Execute Ansible ‘actions’&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/package_module.html#ansible-collections-ansible-builtin-package-module">ansible.builtin.package&lt;/a> – Generic OS package manager&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/package_facts_module.html#ansible-collections-ansible-builtin-package-facts-module">ansible.builtin.package_facts&lt;/a> – Package information as facts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/pause_module.html#ansible-collections-ansible-builtin-pause-module">ansible.builtin.pause&lt;/a> – Pause playbook execution&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/ping_module.html#ansible-collections-ansible-builtin-ping-module">ansible.builtin.ping&lt;/a> – Try to connect to host, verify a usable python and return pong on success&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/pip_module.html#ansible-collections-ansible-builtin-pip-module">ansible.builtin.pip&lt;/a> – Manages Python library dependencies&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/raw_module.html#ansible-collections-ansible-builtin-raw-module">ansible.builtin.raw&lt;/a> – Executes a low-down and dirty command&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/reboot_module.html#ansible-collections-ansible-builtin-reboot-module">ansible.builtin.reboot&lt;/a> – Reboot a machine&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html#ansible-collections-ansible-builtin-replace-module">ansible.builtin.replace&lt;/a> – Replace all instances of a particular string in a file using a back-referenced regular expression&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/rpm_key_module.html#ansible-collections-ansible-builtin-rpm-key-module">ansible.builtin.rpm_key&lt;/a> – Adds or removes a gpg key from the rpm db&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/script_module.html#ansible-collections-ansible-builtin-script-module">ansible.builtin.script&lt;/a> – Runs a local script on a remote node after transferring it&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_module.html#ansible-collections-ansible-builtin-service-module">ansible.builtin.service&lt;/a> – Manage services&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/service_facts_module.html#ansible-collections-ansible-builtin-service-facts-module">ansible.builtin.service_facts&lt;/a> – Return service state information as fact data&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/set_fact_module.html#ansible-collections-ansible-builtin-set-fact-module">ansible.builtin.set_fact&lt;/a> – Set host variable(s) and fact(s).&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/set_stats_module.html#ansible-collections-ansible-builtin-set-stats-module">ansible.builtin.set_stats&lt;/a> – Define and display stats for the current ansible run&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/setup_module.html#ansible-collections-ansible-builtin-setup-module">ansible.builtin.setup&lt;/a> – Gathers facts about remote hosts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/shell_module.html#ansible-collections-ansible-builtin-shell-module">ansible.builtin.shell&lt;/a> – Execute shell commands on targets&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/slurp_module.html#ansible-collections-ansible-builtin-slurp-module">ansible.builtin.slurp&lt;/a> – Slurps a file from remote nodes&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html#ansible-collections-ansible-builtin-stat-module">ansible.builtin.stat&lt;/a> – Retrieve file or file system status&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/subversion_module.html#ansible-collections-ansible-builtin-subversion-module">ansible.builtin.subversion&lt;/a> – Deploys a subversion repository&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/systemd_module.html#ansible-collections-ansible-builtin-systemd-module">ansible.builtin.systemd&lt;/a> – Manage systemd units&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/sysvinit_module.html#ansible-collections-ansible-builtin-sysvinit-module">ansible.builtin.sysvinit&lt;/a> – Manage SysV services.&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/tempfile_module.html#ansible-collections-ansible-builtin-tempfile-module">ansible.builtin.tempfile&lt;/a> – Creates temporary files and directories&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html#ansible-collections-ansible-builtin-template-module">ansible.builtin.template&lt;/a> – Template a file out to a target host&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/unarchive_module.html#ansible-collections-ansible-builtin-unarchive-module">ansible.builtin.unarchive&lt;/a> – Unpacks an archive after (optionally) copying it from the local machine&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/uri_module.html#ansible-collections-ansible-builtin-uri-module">ansible.builtin.uri&lt;/a> – Interacts with webservices&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/user_module.html#ansible-collections-ansible-builtin-user-module">ansible.builtin.user&lt;/a> – Manage user accounts&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/validate_argument_spec_module.html#ansible-collections-ansible-builtin-validate-argument-spec-module">ansible.builtin.validate_argument_spec&lt;/a> – Validate role argument specs.&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/wait_for_module.html#ansible-collections-ansible-builtin-wait-for-module">ansible.builtin.wait_for&lt;/a> – Waits for a condition before continuing&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/wait_for_connection_module.html#ansible-collections-ansible-builtin-wait-for-connection-module">ansible.builtin.wait_for_connection&lt;/a> – Waits until remote system is reachable/usable&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html#ansible-collections-ansible-builtin-yum-module">ansible.builtin.yum&lt;/a> – Manages packages with the yum package manager&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_repository_module.html#ansible-collections-ansible-builtin-yum-repository-module">ansible.builtin.yum_repository&lt;/a> – Add or remove YUM repositories&lt;/li>
&lt;/ul>
&lt;p>根据 &lt;a href="https://docs.ansible.com/ansible/2.9/modules/modules_by_category.html">2.9 版本的模块索引&lt;/a>文档，我们可以将上面这些内置模块进行类别划分&lt;/p>
&lt;h1 id="commands---命令模块">Commands - 命令模块&lt;a class="td-heading-self-link" href="#commands---%e5%91%bd%e4%bb%a4%e6%a8%a1%e5%9d%97" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;blockquote>
&lt;p>官方文档：&lt;a href="https://docs.ansible.com/ansible/2.9/modules/list_of_commands_modules.html">https://docs.ansible.com/ansible/2.9/modules/list_of_commands_modules.html&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/command_module.html#command-module">command – Execute commands on targets&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/expect_module.html#expect-module">expect – Executes a command and responds to prompts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/psexec_module.html#psexec-module">psexec – Runs commands on a remote Windows host based on the PsExec model&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/raw_module.html#raw-module">raw – Executes a low-down and dirty command&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/script_module.html#script-module">script – Runs a local script on a remote node after transferring it&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/shell_module.html#shell-module">shell – Execute shell commands on targets&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/telnet_module.html#telnet-module">telnet – Executes a low-down and dirty telnet command&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="command---在受管理节点上执行命令">command - 在受管理节点上执行命令&lt;a class="td-heading-self-link" href="#command---%e5%9c%a8%e5%8f%97%e7%ae%a1%e7%90%86%e8%8a%82%e7%82%b9%e4%b8%8a%e6%89%a7%e8%a1%8c%e5%91%bd%e4%bb%a4" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/command_module.html&lt;/p>
&lt;h2 id="script---将本地脚本传输到受管理节点上并运行">script - 将本地脚本传输到受管理节点上并运行&lt;a class="td-heading-self-link" href="#script---%e5%b0%86%e6%9c%ac%e5%9c%b0%e8%84%9a%e6%9c%ac%e4%bc%a0%e8%be%93%e5%88%b0%e5%8f%97%e7%ae%a1%e7%90%86%e8%8a%82%e7%82%b9%e4%b8%8a%e5%b9%b6%e8%bf%90%e8%a1%8c" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/script_module.html&lt;/p>
&lt;h1 id="files---文件处理模块">Files - 文件处理模块&lt;a class="td-heading-self-link" href="#files---%e6%96%87%e4%bb%b6%e5%a4%84%e7%90%86%e6%a8%a1%e5%9d%97" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>详见《&lt;a href="https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible%20Modules/ansible.builtin(%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97)/Files%20%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97.md">Files 处理模块&lt;/a>》&lt;/p>
&lt;h1 id="packaging---包模块">Packaging - 包模块&lt;a class="td-heading-self-link" href="#packaging---%e5%8c%85%e6%a8%a1%e5%9d%97" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;blockquote>
&lt;p>官方文档：&lt;a href="https://docs.ansible.com/ansible/2.9/modules/list_of_packaging_modules.html">https://docs.ansible.com/ansible/2.9/modules/list_of_packaging_modules.html&lt;/a>&lt;/p>
&lt;/blockquote>
&lt;h2 id="language">Language&lt;a class="td-heading-self-link" href="#language" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/bower_module.html#bower-module">bower – Manage bower packages with bower&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/bundler_module.html#bundler-module">bundler – Manage Ruby Gem dependencies with Bundler&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/composer_module.html#composer-module">composer – Dependency Manager for PHP&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/cpanm_module.html#cpanm-module">cpanm – Manages Perl library dependencies&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/easy_install_module.html#easy-install-module">easy_install – Installs Python libraries&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/gem_module.html#gem-module">gem – Manage Ruby gems&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/maven_artifact_module.html#maven-artifact-module">maven_artifact – Downloads an Artifact from a Maven Repository&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/npm_module.html#npm-module">npm – Manage node.js packages with npm&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pear_module.html#pear-module">pear – Manage pear/pecl packages&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pip_module.html#pip-module">pip – Manages Python library dependencies&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pip_package_info_module.html#pip-package-info-module">pip_package_info – pip package information&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/yarn_module.html#yarn-module">yarn – Manage node.js packages with Yarn&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="os">OS&lt;a class="td-heading-self-link" href="#os" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apk_module.html#apk-module">apk – Manages apk packages&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apt_module.html#apt-module">apt – Manages apt-packages&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apt_key_module.html#apt-key-module">apt_key – Add or remove an apt key&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apt_repo_module.html#apt-repo-module">apt_repo – Manage APT repositories via apt-repo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apt_repository_module.html#apt-repository-module">apt_repository – Add and remove APT repositories&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/apt_rpm_module.html#apt-rpm-module">apt_rpm – apt_rpm package manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/dnf_module.html#dnf-module">dnf – Manages packages with the dnf package manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/dpkg_selections_module.html#dpkg-selections-module">dpkg_selections – Dpkg package selection selections&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/flatpak_module.html#flatpak-module">flatpak – Manage flatpaks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/flatpak_remote_module.html#flatpak-remote-module">flatpak_remote – Manage flatpak repository remotes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/homebrew_module.html#homebrew-module">homebrew – Package manager for Homebrew&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/homebrew_cask_module.html#homebrew-cask-module">homebrew_cask – Install/uninstall homebrew casks&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/homebrew_tap_module.html#homebrew-tap-module">homebrew_tap – Tap a Homebrew repository&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/installp_module.html#installp-module">installp – Manage packages on AIX&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/layman_module.html#layman-module">layman – Manage Gentoo overlays&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/macports_module.html#macports-module">macports – Package manager for MacPorts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/openbsd_pkg_module.html#openbsd-pkg-module">openbsd_pkg – Manage packages on OpenBSD&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/opkg_module.html#opkg-module">opkg – Package manager for OpenWrt&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/package_module.html#package-module">package – Generic OS package manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/package_facts_module.html#package-facts-module">package_facts – package information as facts&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pacman_module.html#pacman-module">pacman – Manage packages with pacman&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pkg5_module.html#pkg5-module">pkg5 – Manages packages with the Solaris 11 Image Packaging System&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pkg5_publisher_module.html#pkg5-publisher-module">pkg5_publisher – Manages Solaris 11 Image Packaging System publishers&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pkgin_module.html#pkgin-module">pkgin – Package manager for SmartOS, NetBSD, et al&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pkgng_module.html#pkgng-module">pkgng – Package manager for FreeBSD &amp;gt;= 9.0&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pkgutil_module.html#pkgutil-module">pkgutil – Manage CSW-Packages on Solaris&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/portage_module.html#portage-module">portage – Package manager for Gentoo&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/portinstall_module.html#portinstall-module">portinstall – Installing packages from FreeBSD’s ports system&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pulp_repo_module.html#pulp-repo-module">pulp_repo – Add or remove Pulp repos from a remote host&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/redhat_subscription_module.html#redhat-subscription-module">redhat_subscription – Manage registration and subscriptions to RHSM using the subscription-manager command&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/rhn_channel_module.html#rhn-channel-module">rhn_channel – Adds or removes Red Hat software channels&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/rhn_register_module.html#rhn-register-module">rhn_register – Manage Red Hat Network registration using the rhnreg_ks command&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/rhsm_release_module.html#rhsm-release-module">rhsm_release – Set or Unset RHSM Release version&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/rhsm_repository_module.html#rhsm-repository-module">rhsm_repository – Manage RHSM repositories using the subscription-manager command&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/rpm_key_module.html#rpm-key-module">rpm_key – Adds or removes a gpg key from the rpm db&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/slackpkg_module.html#slackpkg-module">slackpkg – Package manager for Slackware &amp;gt;= 12.2&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/snap_module.html#snap-module">snap – Manages snaps&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/sorcery_module.html#sorcery-module">sorcery – Package manager for Source Mage GNU/Linux&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/svr4pkg_module.html#svr4pkg-module">svr4pkg – Manage Solaris SVR4 packages&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/swdepot_module.html#swdepot-module">swdepot – Manage packages with swdepot package manager (HP-UX)&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/swupd_module.html#swupd-module">swupd – Manages updates and bundles in ClearLinux systems&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/urpmi_module.html#urpmi-module">urpmi – Urpmi manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/xbps_module.html#xbps-module">xbps – Manage packages with XBPS&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/yum_module.html#yum-module">yum – Manages packages with the yum package manager&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/yum_repository_module.html#yum-repository-module">yum_repository – Add or remove YUM repositories&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/zypper_module.html#zypper-module">zypper – Manage packages on SUSE and openSUSE&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/zypper_repository_module.html#zypper-repository-module">zypper_repository – Add and remove Zypper repositories&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="yum---使用主机上的-yum-工具管理包">yum - 使用主机上的 yum 工具管理包&lt;a class="td-heading-self-link" href="#yum---%e4%bd%bf%e7%94%a8%e4%b8%bb%e6%9c%ba%e4%b8%8a%e7%9a%84-yum-%e5%b7%a5%e5%85%b7%e7%ae%a1%e7%90%86%e5%8c%85" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/yum_module.html&lt;/p>
&lt;h3 id="参数">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;ul>
&lt;li>&lt;strong>name(STRING)&lt;/strong> # 包的名称&lt;/li>
&lt;li>&lt;strong>state(STRING)&lt;/strong> # 指定要执行的操作，是安装还是移除包。可用的值有如下几个：
&lt;ul>
&lt;li>absent 与 removed # 移除指定的包&lt;/li>
&lt;li>installed 与 present # 简单得确保安装了指定的包&lt;/li>
&lt;li>latest # 安装最新版本的包，若当前包不是最新版本，则更新它。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3 id="应用示例">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;p>安装 bash-completion 与 vim 的最新版本的包&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>ansible all -m yum -a &lt;span style="color:#e6db74">&amp;#34;name=net-bash-completion,vim state=latest&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>- name: 安装运维工具
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> yum:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> name: &lt;span style="color:#f92672">[&lt;/span>&lt;span style="color:#e6db74">&amp;#39;bash-completion&amp;#39;&lt;/span>,&lt;span style="color:#e6db74">&amp;#39;vim&amp;#39;&lt;/span>&lt;span style="color:#f92672">]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> state: latest
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="system---系统模块">System - 系统模块&lt;a class="td-heading-self-link" href="#system---%e7%b3%bb%e7%bb%9f%e6%a8%a1%e5%9d%97" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>详见 《&lt;a href="https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible%20Modules/ansible.builtin(%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97)/System%20%E6%A8%A1%E5%9D%97.md">System 模块&lt;/a>》&lt;/p>
&lt;h1 id="utilities---实用程序模块">Utilities - 实用程序模块&lt;a class="td-heading-self-link" href="#utilities---%e5%ae%9e%e7%94%a8%e7%a8%8b%e5%ba%8f%e6%a8%a1%e5%9d%97" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;h2 id="helper">Helper&lt;a class="td-heading-self-link" href="#helper" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/meta_module.html#meta-module">meta – Execute Ansible ‘actions’&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="logic">Logic&lt;a class="td-heading-self-link" href="#logic" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/assert_module.html#assert-module">assert – Asserts given expressions are true&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/async_status_module.html#async-status-module">async_status – Obtain status of asynchronous task&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/debug_module.html#debug-module">debug – Print statements during execution&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/fail_module.html#fail-module">fail – Fail with custom message&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/import_playbook_module.html#import-playbook-module">import_playbook – Import a playbook&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/import_role_module.html#import-role-module">import_role – Import a role into a play&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/import_tasks_module.html#import-tasks-module">import_tasks – Import a task list&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/include_module.html#include-module">include – Include a play or task list&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/include_role_module.html#include-role-module">include_role – Load and execute a role&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/include_tasks_module.html#include-tasks-module">include_tasks – Dynamically include a task list&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/include_vars_module.html#include-vars-module">include_vars – Load variables from files, dynamically within a task&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/pause_module.html#pause-module">pause – Pause playbook execution&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/set_fact_module.html#set-fact-module">set_fact – Set host facts from a task&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/set_stats_module.html#set-stats-module">set_stats – Set stats for the current ansible run&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/wait_for_module.html#wait-for-module">wait_for – Waits for a condition before continuing&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/wait_for_connection_module.html#wait-for-connection-module">wait_for_connection – Waits until remote system is reachable/usable&lt;/a>&lt;/li>
&lt;/ul>
&lt;h2 id="debug---输出变量或表达式">debug - 输出变量或表达式&lt;a class="td-heading-self-link" href="#debug---%e8%be%93%e5%87%ba%e5%8f%98%e9%87%8f%e6%88%96%e8%a1%a8%e8%be%be%e5%bc%8f" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/debug_module.html&lt;/p>
&lt;p>该模块可以在 playbook 执行期间，输出指定的内容，而不用停止 playbook。常用于调试变量或者表达式。比如使用 shell 模块的时候，可以通过 debug 模块来输出 shell 模块定义的语句的执行结果&lt;/p>
&lt;p>常与 when 指令一起使用。&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Print the gateway for each host when defined&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>: &lt;span style="color:#ae81ff">System {{ inventory_hostname }} has gateway {{ ansible_default_ipv4.gateway }}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">when&lt;/span>: &lt;span style="color:#ae81ff">ansible_default_ipv4.gateway is defined&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Get uptime information&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.shell&lt;/span>: &lt;span style="color:#ae81ff">/usr/bin/uptime&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">register&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Print return information from the previous task&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">var&lt;/span>: &lt;span style="color:#ae81ff">result&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">verbosity&lt;/span>: &lt;span style="color:#ae81ff">2&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Display all variables/facts known for a host&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">var&lt;/span>: &lt;span style="color:#ae81ff">hostvars[inventory_hostname]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">verbosity&lt;/span>: &lt;span style="color:#ae81ff">4&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">Prints two lines of messages, but only if there is an environment value set&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.debug&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">msg&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;Provisioning based on YOUR_KEY which is: {{ lookup(&amp;#39;env&amp;#39;, &amp;#39;YOUR_KEY&amp;#39;) }}&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#e6db74">&amp;#34;These servers were built using the password of &amp;#39;{{ password_used }}&amp;#39;. Please retain this for later use.&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="fail---终止任务的执行并输出自定义的消息">fail - 终止任务的执行，并输出自定义的消息&lt;a class="td-heading-self-link" href="#fail---%e7%bb%88%e6%ad%a2%e4%bb%bb%e5%8a%a1%e7%9a%84%e6%89%a7%e8%a1%8c%e5%b9%b6%e8%be%93%e5%87%ba%e8%87%aa%e5%ae%9a%e4%b9%89%e7%9a%84%e6%b6%88%e6%81%af" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/fail_module.html&lt;/p>
&lt;h2 id="import-与-include-模块---在主任务中导入其他任务或变量">import 与 include 模块 - 在主任务中导入其他任务或变量&lt;a class="td-heading-self-link" href="#import-%e4%b8%8e-include-%e6%a8%a1%e5%9d%97---%e5%9c%a8%e4%b8%bb%e4%bb%bb%e5%8a%a1%e4%b8%ad%e5%af%bc%e5%85%a5%e5%85%b6%e4%bb%96%e4%bb%bb%e5%8a%a1%e6%88%96%e5%8f%98%e9%87%8f" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://www.cnblogs.com/mauricewei/p/10054041.html">https://www.cnblogs.com/mauricewei/p/10054041.html&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.5/user_guide/playbooks_reuse.html#differences-between-static-and-dynamic">https://docs.ansible.com/ansible/2.5/user_guide/playbooks_reuse.html#differences-between-static-and-dynamic&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.5/user_guide/playbooks_conditionals.html#applying-when-to-roles-imports-and-includes">https://docs.ansible.com/ansible/2.5/user_guide/playbooks_conditionals.html#applying-when-to-roles-imports-and-includes&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>随着要管理的服务不断增多，我们的 Playbook 也会越来越大，内容越来越多，管理起来也会随着复杂。这时，我们可以将某些 tasks 分散到很多文件中，通过 import 和 include 相关模块，实现 tasks 文件之间的相互调用。&lt;/p>
&lt;p>说白了，就是聚合多个文件的 tasks。&lt;/p>
&lt;p>一共有如下几种模块可以实现这类功能：&lt;/p>
&lt;ul>
&lt;li>import_playbook&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/import_role_module.html">import_role&lt;/a> #&lt;/li>
&lt;li>import_tasks # &lt;strong>Static(静态)&lt;/strong> 方法，在 playbooks 解析阶段将父 task 变量和子 task 变量全部读取并加载&lt;/li>
&lt;li>include&lt;/li>
&lt;li>include_tasks # &lt;strong>Dynamic(动态)&lt;/strong> 方法，在执行 play 之前才会加载自己变量&lt;/li>
&lt;li>include_vars&lt;/li>
&lt;/ul>
&lt;h3 id="动态与静态导入-tasks-的区别">动态与静态导入 tasks 的区别&lt;a class="td-heading-self-link" href="#%e5%8a%a8%e6%80%81%e4%b8%8e%e9%9d%99%e6%80%81%e5%af%bc%e5%85%a5-tasks-%e7%9a%84%e5%8c%ba%e5%88%ab" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;h4 id="区别一">区别一&lt;a class="td-heading-self-link" href="#%e5%8c%ba%e5%88%ab%e4%b8%80" aria-label="Heading self-link">&lt;/a>&lt;/h4>
&lt;ul>
&lt;li>import_tasks(Static) 方法会在 playbooks 解析阶段将父 task 变量和子 task 变量全部读取并加载&lt;/li>
&lt;li>include_tasks(Dynamic) 方法则是在执行 play 之前才会加载自己变量&lt;/li>
&lt;/ul>
&lt;p>可能有点懵，举例说明&lt;/p>
&lt;p>&lt;strong>下面两个例子是 test.yml 里的 task 调用 test2.yml，不同之处是一个使用 import_tasks 另一个使用 include_tasks&lt;/strong>&lt;/p>
&lt;p>import_tasks：在执行 tasks 之前，ansible 解释器会先加载 test.yml 里的变量同时再加载 test2.yml 里的变量，那么 ansible_os_family 变量会有一个覆盖现象产生，最终的参数应为“BlackHat”，所以当 test.yml 里执行 when 语句时，ansible_os_family 被判定为“BlackHat”，when 的判断结果为 false，也就不会调用 test2.yml 了&lt;/p>
&lt;p>执行结果如下，test2.yml 里的 task 都被 skip 了：&lt;/p>
&lt;p>include_tasks：ansible 会在完全执行完 test.yml 里的 task 后才会加载 test2.yml 里的变量，所以当执行 when 语句时，ansible_os_family 的参数应为“RedHat”，此时 when 语句判断结果是 true，也就是 test2.yml 里的 tasks 会被执行。&lt;/p>
&lt;p>将第一张图 test.yaml 里的 import_tasks 换成 include_tasks，执行结果如下：&lt;/p>
&lt;p>我们发现自 test2.yml 里的 task 被执行了，并且在 test2.yml 里 ansible_os_family 的参数变为了“BlackHat”。&lt;/p>
&lt;p>这就是 include_tasts 和 import_tasks 方法的第一个区别。&lt;/p>
&lt;h4 id="区别二">区别二&lt;a class="td-heading-self-link" href="#%e5%8c%ba%e5%88%ab%e4%ba%8c" aria-label="Heading self-link">&lt;/a>&lt;/h4>
&lt;ul>
&lt;li>include_tasks 方法调用的文件名称可以加变量&lt;/li>
&lt;li>import_tasks 方法调用的文件名称不可以有变量&lt;/li>
&lt;/ul>
&lt;p>这个区别比较简单，直接上示例：&lt;/p>
&lt;p>当调用的文件名称有变量时，使用 include_tasks 方法：&lt;/p>
&lt;p>能够正常调用 test2.yml，执行结果如下：&lt;/p>
&lt;p>当使用 import_tasks 方法时，执行报错。&lt;/p>
&lt;p>ansible 也给出了错误原因，当使用 static include 时，是不能使用变量的：&lt;/p>
&lt;p>这就是 include_tasts 和 import_tasks 方法的第二个区别。&lt;/p></description></item><item><title>Docs: Files 类模块</title><link>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/Files-%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Ansible-Modules/ansible.builtin%E5%86%85%E7%BD%AE%E6%A8%A1%E5%9D%97/Files-%E5%A4%84%E7%90%86%E6%A8%A1%E5%9D%97/</guid><description>
&lt;h1 id="概述">概述&lt;a class="td-heading-self-link" href="#%e6%a6%82%e8%bf%b0" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;blockquote>
&lt;p>参考：&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/list_of_files_modules.html">官方文档 2.9，用户指南-使用模块-模块索引-文件模块&lt;/a>&lt;/li>
&lt;/ul>
&lt;/blockquote>
&lt;p>Files 类别模块用来处理文件、文本&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/acl_module.html#acl-module">acl – Set and retrieve file ACL information&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/archive_module.html#archive-module">archive – Creates a compressed archive of one or more files or trees&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/assemble_module.html#assemble-module">assemble – Assemble configuration files from fragments&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/blockinfile_module.html#blockinfile-module">blockinfile # 添加、更新、删除指定的多行文本。Insert/update/remove a text block surrounded by marker lines&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/copy_module.html#copy-module">copy # 用于将文件从本地或远程设备上复制到远程设备上的某个位置。Copy files to remote locations&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/fetch_module.html#fetch-module">fetch – Fetch files from remote nodes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/file_module.html#file-module">file # 管理文件和文件熟悉，用于创建文件、目录等。Manage files and file properties&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/find_module.html#find-module">find – Return a list of files based on specific criteria&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/ini_file_module.html#ini-file-module">ini_file – Tweak settings in INI files&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/iso_extract_module.html#iso-extract-module">iso_extract – Extract files from an ISO image&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/lineinfile_module.html#lineinfile-module">lineinfile # 与 sed 命令类似，修改指定文件中匹配到的行或添加行。Manage lines in text files&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/patch_module.html#patch-module">patch – Apply patch files using the GNU patch tool&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/read_csv_module.html#read-csv-module">read_csv – Read a CSV file&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/replace_module.html#replace-module">replace – Replace all instances of a particular string in a file using a back-referenced regular expression&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/stat_module.html#stat-module">stat # 获取文件或文件系统状态 Retrieve file or file system status&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/synchronize_module.html#synchronize-module">synchronize – A wrapper around rsync to make common tasks in your playbooks quick and easy&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/tempfile_module.html#tempfile-module">tempfile – Creates temporary files and directories&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/template_module.html#template-module">template # 根据文件模板，在远程主机上生成新文件。Template a file out to a remote server&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/unarchive_module.html#unarchive-module">unarchive # 解压缩一个归档文件。就是 tar 命。Unpacks an archive after (optionally) copying it from the local machine&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/xattr_module.html#xattr-module">xattr – Manage user defined extended attributes&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.ansible.com/ansible/2.9/modules/xml_module.html#xml-module">xml – Manage bits and pieces of XML files or strings&lt;/a>&lt;/li>
&lt;/ul>
&lt;h1 id="blockinfile---添加更新删除指定的多行文本">blockinfile - 添加、更新、删除指定的多行文本&lt;a class="td-heading-self-link" href="#blockinfile---%e6%b7%bb%e5%8a%a0%e6%9b%b4%e6%96%b0%e5%88%a0%e9%99%a4%e6%8c%87%e5%ae%9a%e7%9a%84%e5%a4%9a%e8%a1%8c%e6%96%87%e6%9c%ac" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/blockinfile_module.html&lt;/p>
&lt;p>blockinfile 模块使用示例：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#ae81ff">name:写入多行文本&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">blockinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/etc/hosts&lt;/span> &lt;span style="color:#75715e"># 指定要添加文本的文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">block&lt;/span>: &lt;span style="color:#ae81ff">|&lt;/span> &lt;span style="color:#75715e"># 注意要使用 | 符号，否则将没有换行。&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">10.0.13.77&lt;/span> &lt;span style="color:#ae81ff">iptv-k8s-master-1.tjiptv.net&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#ae81ff">10.0.13.82&lt;/span> &lt;span style="color:#ae81ff">iptv-k8s-master-2.tjiptv.net&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>添加结果&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">[&lt;/span>root@lichenhao ~&lt;span style="color:#f92672">]&lt;/span>&lt;span style="color:#75715e"># cat /etc/hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>127.0.0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>::1 localhost localhost.localdomain localhost6 localhost6.localdomain6
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># BEGIN ANSIBLE MANAGED BLOCK&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.0.13.77 iptv-k8s-master-1.tjiptv.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>10.0.13.82 iptv-k8s-master-2.tjiptv.net
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#75715e"># END ANSIBLE MANAGED BLOCK&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note：&lt;/p>
&lt;ul>
&lt;li>blockinfile 模块会将 block 字段下面的所有内容当做一个文本块来看，将这一块内容全部添加到指定文件中 block 位置
&lt;ul>
&lt;li>block 位置是由 # BEGIN ANSIBLE MANAGED BLOCK 与 # END ANSIBLE MANAGED BLOCK 两行夹在中间的所有位置。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>如果再次执行该任务，则会将 block 下指定的文本块覆盖到目标文件 ANSIBLE 所表示的那几行，而不会添加到文件末尾&lt;/li>
&lt;/ul>
&lt;h1 id="copy---用于将文件拷贝到被管理设备上的某个位置">copy - 用于将文件拷贝到被管理设备上的某个位置&lt;a class="td-heading-self-link" href="#copy---%e7%94%a8%e4%ba%8e%e5%b0%86%e6%96%87%e4%bb%b6%e6%8b%b7%e8%b4%9d%e5%88%b0%e8%a2%ab%e7%ae%a1%e7%90%86%e8%ae%be%e5%a4%87%e4%b8%8a%e7%9a%84%e6%9f%90%e4%b8%aa%e4%bd%8d%e7%bd%ae" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档: &lt;a href="https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html">https://docs.ansible.com/ansible/latest/collections/ansible/builtin/copy_module.html&lt;/a>&lt;/p>
&lt;h2 id="参数">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>必选参数
&lt;ul>
&lt;li>&lt;strong>src(PATH)&lt;/strong> # 待拷贝的源文件路径。默认从 Ansible 控制节点搜索路径，搜索逻辑可以被 remote_src 参数修改&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>可选参数
&lt;ul>
&lt;li>&lt;strong>remote_src(BOOLEAN)&lt;/strong> # 若开启 remote_src 参数，则 src 参数将会从被管理节点搜索待拷贝的源文件。&lt;code>默认值:false&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2 id="应用示例">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-bash" data-lang="bash">&lt;span style="display:flex;">&lt;span>~&lt;span style="color:#f92672">]&lt;/span>$ ansible all -m copy -a &lt;span style="color:#e6db74">&amp;#34;src=https://desistdaydream.github.io/etc/hosts dest=/tmp/hosts&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>~&lt;span style="color:#f92672">]&lt;/span>$ ansible all -m file -a &lt;span style="color:#e6db74">&amp;#34;dest=/tmp/hosts mode=755 owner=lichenhao group=lichenhao state=directory&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">拷贝文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">ansible.builtin.copy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">src&lt;/span>: &lt;span style="color:#ae81ff">/etc/hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/tmp/hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">创建目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">copy&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/tmp/hosts&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">mode&lt;/span>: &lt;span style="color:#ae81ff">0755&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">lichenhao&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">lichenhao&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">directory&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="file---用于创建文件目录等">file - 用于创建文件、目录等&lt;a class="td-heading-self-link" href="#file---%e7%94%a8%e4%ba%8e%e5%88%9b%e5%bb%ba%e6%96%87%e4%bb%b6%e7%9b%ae%e5%bd%95%e7%ad%89" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/file_module.html#file-module&lt;/p>
&lt;h2 id="应用示例-1">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-1" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">创建名为k8s的目录&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">file&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#ae81ff">/etc/ssl/k8s&lt;/span> &lt;span style="color:#75715e"># 指定要创建的路径&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">owner&lt;/span>: &lt;span style="color:#ae81ff">k8s&lt;/span> &lt;span style="color:#75715e">#可省。默认所属用户为root&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">group&lt;/span>: &lt;span style="color:#ae81ff">k8s&lt;/span> &lt;span style="color:#75715e">#可省。默认所属组为k8s&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">state&lt;/span>: &lt;span style="color:#ae81ff">directory&lt;/span> &lt;span style="color:#75715e"># 指定要创建的类型为目录&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Note: state 还可以使用 link 用来创建软链接&lt;/p>
&lt;h1 id="文本替换">文本替换&lt;a class="td-heading-self-link" href="#%e6%96%87%e6%9c%ac%e6%9b%bf%e6%8d%a2" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>lineinfile、replace、blockinfile 这三个模块可以实现文本编辑功能，类似于 sed。&lt;/p>
&lt;ul>
&lt;li>replace 模块可以对多行中的文本执行操作。&lt;/li>
&lt;li>lineinfile 模块对一行全部内容执行操作。&lt;/li>
&lt;li>blockinfile 模块可以在文件中插入、更新、删除一行&lt;/li>
&lt;/ul>
&lt;p>对于其他情况的文本编辑，则需要使用 copy、template 等模块直接生成文件，而不是编辑文件。&lt;/p>
&lt;p>虽然都是行匹配，但是 replace 只会替换匹配到行的字符串，而 lineinfile 则会替换匹配到整行。&lt;/p>
&lt;h2 id="lineinfile---行替换">lineinfile - 行替换&lt;a class="td-heading-self-link" href="#lineinfile---%e8%a1%8c%e6%9b%bf%e6%8d%a2" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/lineinfile_module.html&lt;/p>
&lt;ul>
&lt;li>此模块确保文件中包含特定行，或使用向后引用的正则表达式替换现有行。&lt;/li>
&lt;li>当我们只想更改文件中的单行时，这主要有用。如果匹配到多行，那么只会对最后一行进行操作&lt;/li>
&lt;/ul>
&lt;h3 id="参数-1">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0-1" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;p>必填参数：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>path&lt;/strong> # 要修改的文件&lt;/li>
&lt;/ul>
&lt;p>其他参数：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>regexp&lt;/strong> # 正则表达式，用以匹配需要修改的行&lt;/li>
&lt;/ul>
&lt;p>注意&lt;/p>
&lt;ul>
&lt;li>如果 regexp 和 insertbefore 同时存在，则仅在找不到与 regexp 匹配的情况下才使用 insertbefore。不可与 backref 一起使用。&lt;/li>
&lt;li>insertafter EOF 与 insertbefore BOF 分别表示在文件末尾以及文件开头插入指定的行&lt;/li>
&lt;/ul>
&lt;h3 id="应用示例-2">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-2" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;p>取消 UseDNS no 行前的 &lt;code>#&lt;/code> 号&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">修改指定行的内容&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/etc/ssh/sshd_config&lt;/span> &lt;span style="color:#75715e"># 指定要修改的文件&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;#(UseDNS\\s*no)&amp;#34;&lt;/span> &lt;span style="color:#75715e"># 使用正则表达式进行内容匹配&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">line&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;\1&amp;#39;&lt;/span> &lt;span style="color:#75715e"># 引用正则表达式中()匹配的内容&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">backrefs&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span> &lt;span style="color:#75715e"># 指定是否可以进行引用，如果不指定，则匹配到的行会变成\1而不是通过\1引用的内容。&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>在指定匹配到的最后一行之前或者之后添加行&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">在指定行之前或者之后添加行&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/usr/lib/systemd/system/docker.service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^ExecStartPost=&amp;#34;&lt;/span> &lt;span style="color:#75715e"># (可省略)如果未匹配到regexp中的内容，则执行insertabefore。如果匹配到了，则不再匹配insertbefore，直接将匹配到的行替换成line指定的行。&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">insertbefore&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^ExecReload=&amp;#34;&lt;/span> &lt;span style="color:#75715e"># 在该字段指定的行之前添加line指定的内容。如果想再指定的行之后添加，则使用insertafter关键字&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">line&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ExecStartPost=/usr/sbin/iptables -P FORWARD ACCEPT&amp;#34;&lt;/span> &lt;span style="color:#75715e"># 要添加的行&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>配置 Docker 启动参数&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">name&lt;/span>: &lt;span style="color:#ae81ff">配置docker启动参数&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">block&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/usr/lib/systemd/system/docker.service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^ExecStartPost=&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">insertbefore&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;^ExecReload=&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">line&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;ExecStartPost=/usr/sbin/iptables -P FORWARD ACCEPT&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> - &lt;span style="color:#f92672">lineinfile&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">dest&lt;/span>: &lt;span style="color:#ae81ff">/usr/lib/systemd/system/docker.service&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;(ExecStart=/usr/bin/dockerd -H fd:// --containerd=/run/containerd/containerd.sock)&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">line&lt;/span>: &lt;span style="color:#e6db74">&amp;#39;\1 {{docker.options}}&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">backrefs&lt;/span>: &lt;span style="color:#66d9ef">yes&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="replace---字符替换">replace - 字符替换&lt;a class="td-heading-self-link" href="#replace---%e5%ad%97%e7%ac%a6%e6%9b%bf%e6%8d%a2" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/replace_module.html&lt;/p>
&lt;h3 id="参数-2">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0-2" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;p>必填参数：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>path&lt;/strong> # 要修改的文件。&lt;/li>
&lt;li>&lt;strong>regexp&lt;/strong> # 正则表达式，匹配到需要修改的字符串&lt;/li>
&lt;li>&lt;strong>replace&lt;/strong> # 替换 regexp 参数匹配到的字符串。若不指定该参数，则会删除 regexp 参数匹配到的字符串。&lt;/li>
&lt;/ul>
&lt;p>其他参数：&lt;/p>
&lt;h3 id="应用示例-3">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-3" aria-label="Heading self-link">&lt;/a>&lt;/h3>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>- &lt;span style="color:#f92672">replace&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">path&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/etc/apt/apt.conf.d/10periodic&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">regexp&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;1&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">replace&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;0&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h1 id="stat---获取文件或文件系统状态">stat - 获取文件或文件系统状态&lt;a class="td-heading-self-link" href="#stat---%e8%8e%b7%e5%8f%96%e6%96%87%e4%bb%b6%e6%88%96%e6%96%87%e4%bb%b6%e7%b3%bb%e7%bb%9f%e7%8a%b6%e6%80%81" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/stat_module.html#stat-module&lt;/p>
&lt;p>stat 模块类似于 Linux 中的 &lt;code>stat&lt;/code> 命令。常用来在改变文件之间，获取某些文件状态，并注册为变量，以便为后续任务进行判断。&lt;/p>
&lt;h2 id="应用示例-4">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-4" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;h1 id="template---根据文件模板在远程主机上生成新文件">template - 根据文件模板，在远程主机上生成新文件&lt;a class="td-heading-self-link" href="#template---%e6%a0%b9%e6%8d%ae%e6%96%87%e4%bb%b6%e6%a8%a1%e6%9d%bf%e5%9c%a8%e8%bf%9c%e7%a8%8b%e4%b8%bb%e6%9c%ba%e4%b8%8a%e7%94%9f%e6%88%90%e6%96%b0%e6%96%87%e4%bb%b6" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/template_module.html&lt;/p>
&lt;p>template 模块使用 Jinja2 模板语言处理文件，并将渲染后的文件传送到目标主机上。&lt;/p>
&lt;h2 id="包含变量">包含变量&lt;a class="td-heading-self-link" href="#%e5%8c%85%e5%90%ab%e5%8f%98%e9%87%8f" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;ul>
&lt;li>ansible_managed # (configurable via the defaults section of ansible.cfg) contains a string which can be used to describe the template name, host, modification time of the template file and the owner uid.&lt;/li>
&lt;li>template_host # contains the node name of the template’s machine.&lt;/li>
&lt;li>template_uid # is the numeric user id of the owner.&lt;/li>
&lt;li>template_path # is the path of the template.&lt;/li>
&lt;li>template_fullpath # is the absolute path of the template.&lt;/li>
&lt;li>template_destpath # is the path of the template on the remote system (added in 2.8).&lt;/li>
&lt;li>template_run_date # is the date that the template was rendered.&lt;/li>
&lt;/ul>
&lt;h2 id="参数-3">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0-3" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;p>必选参数&lt;/p>
&lt;ul>
&lt;li>&lt;strong>dest&lt;/strong> # 渲染后的模板文件被发送到目标主机的位置&lt;/li>
&lt;li>&lt;strong>src&lt;/strong> # Ansible 控制节点上 Jinja2 格式的模板文件路径。&lt;/li>
&lt;/ul>
&lt;p>Jinja 行为控制&lt;/p>
&lt;ul>
&lt;li>&lt;strong>lstrip_blocks&lt;/strong># 是否移除前导空白符和制表符。&lt;code>默认值：no&lt;/code>&lt;/li>
&lt;li>&lt;strong>trim_blocks&lt;/strong> # 是否移除换行符。&lt;code>默认值：yes&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>其他参数&lt;/p>
&lt;ul>
&lt;li>&lt;strong>backup(BOOLEAN)&lt;/strong> # 是否创建一个包含时间戳信息的备份文件。&lt;code>默认值：no&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2 id="返回值">返回值&lt;a class="td-heading-self-link" href="#%e8%bf%94%e5%9b%9e%e5%80%bc" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;msg&amp;#34;&lt;/span>&lt;span style="color:#960050;background-color:#1e0010">:&lt;/span> {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;changed&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;checksum&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;d176c556a237d7d62f8e1a95ffcec7c06c1e6851&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;dest&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/tmp/template_variables.conf&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;diff&amp;#34;&lt;/span>: [],
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;failed&amp;#34;&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;gid&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">0&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;group&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;md5sum&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;2f549414973ec5b547e40d0f49357ce5&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;mode&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;0644&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;owner&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;root&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;size&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">329&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;src&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;/home/lichenhao/.ansible/tmp/ansible-tmp-1634401131.4389606-251148042480663/source&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;state&amp;#34;&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;file&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;uid&amp;#34;&lt;/span>: &lt;span style="color:#ae81ff">0&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> }
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="应用示例-5">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-5" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#ae81ff">ansible -m template -a &amp;#39;src=https://desistdaydream.github.io/mytemplates/foo.j2 dest=/tmp/foo.conf lstrip_blocks=yes&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>模板文件示例：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-shell" data-lang="shell">&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>% &lt;span style="color:#66d9ef">if&lt;/span> docker.registryMirrors is defined %&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#75715e">#如果docker.registryMirrors变量存在，则执行最后一行之前的语句&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;registry-mirrors&amp;#34;&lt;/span>: &lt;span style="color:#f92672">[{&lt;/span>% &lt;span style="color:#66d9ef">for&lt;/span> mirror in docker.registryMirrors %&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#75715e">#输出 &amp;#34;registry-mirrors&amp;#34;: 后执行for循环，将docker.registryMirrors变量的多个值逐一传递给mirror变量，直到docker.registryMirros变量里的值全部引用完成&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;{{ mirror}}&amp;#34;&lt;/span>&lt;span style="color:#f92672">{&lt;/span>% &lt;span style="color:#66d9ef">if&lt;/span> not loop.last %&lt;span style="color:#f92672">}&lt;/span>,&lt;span style="color:#f92672">{&lt;/span>% endif %&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#75715e">#输出 mirror 变量的值。如果循环没有结束，则输出一个逗号&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">{&lt;/span>%- endfor %&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#75715e">#结束for循环&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">]&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">{&lt;/span>% endif %&lt;span style="color:#f92672">}&lt;/span> &lt;span style="color:#75715e">#结束if结构&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>&lt;span style="color:#f92672">}&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>输出结果示例：&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-json" data-lang="json">&lt;span style="display:flex;">&lt;span>{
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#f92672">&amp;#34;registry-mirrors&amp;#34;&lt;/span>: [
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://ac1rmo5p.mirror.aliyuncs.com&amp;#34;&lt;/span>,
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> &lt;span style="color:#e6db74">&amp;#34;https://123.123.123&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span> ]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>更多 template 模块原理及应用，详见 &lt;a href="https://desistdaydream.github.io/docs/9.%E8%BF%90%E7%BB%B4/Ansible/Playbook/Templates%20%E6%A8%A1%E6%9D%BF(Jinja2).md">Playbook 章节中的 Templates&lt;/a>&lt;/p>
&lt;h1 id="unarchive---解压缩一个归档文件就是-tar-命令">unarchive - 解压缩一个归档文件。就是 tar 命令&lt;a class="td-heading-self-link" href="#unarchive---%e8%a7%a3%e5%8e%8b%e7%bc%a9%e4%b8%80%e4%b8%aa%e5%bd%92%e6%a1%a3%e6%96%87%e4%bb%b6%e5%b0%b1%e6%98%af-tar-%e5%91%bd%e4%bb%a4" aria-label="Heading self-link">&lt;/a>&lt;/h1>
&lt;p>官方文档：https://docs.ansible.com/ansible/latest/collections/ansible/builtin/unarchive_module.html&lt;/p>
&lt;h2 id="参数-4">参数&lt;a class="td-heading-self-link" href="#%e5%8f%82%e6%95%b0-4" aria-label="Heading self-link">&lt;/a>&lt;/h2>
&lt;h2 id="应用示例-6">应用示例&lt;a class="td-heading-self-link" href="#%e5%ba%94%e7%94%a8%e7%a4%ba%e4%be%8b-6" aria-label="Heading self-link">&lt;/a>&lt;/h2></description></item></channel></rss>